import joblib
from joblib import load
from sklearn.ensemble import RandomForestClassifier
import pandas as pd
import csv
import numpy as np
model = joblib.load('./random_forest.joblib')
print(type(model))

data=pd.read_csv('./packet_output.csv')
data=pd.DataFrame(data)
data=np.array(data)
print(data)
inp=np.array([[0.00000000e+00, 1.99156428e-01, 0.00000000e+00, 7.86000000e+02,
  6.91727832e-01, 1.71213617e-02, 6.00000000e+00, 7.86000000e+02,
  1.40186203e-01, 1.65508938e+15, 1.65508938e+15, 7.52725220e-03,
  8.16603166e-06],
 [4.99033680e-08, 2.07683844e-02, 1.13684917e-02, 7.86000000e+02,
  3.20449239e-04, 5.15341467e-02, 6.00000000e+00, 7.86000000e+02,
  5.75717338e-01, 1.65520249e+15, 1.65520249e+15, 3.65786748e-03,
  6.74920079e-02],
 [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 7.86000000e+02,
  1.41897975e-01, 0.00000000e+00, 6.00000000e+00, 7.86000000e+02,
  7.30906593e-01, 1.65522141e+15, 1.65522141e+15, 0.00000000e+00,
  0.00000000e+00],
 [1.04773790e-09, 4.98196711e-03, 1.76402368e-02, 7.86000000e+02,
  1.40372026e-01, 4.40982844e-02, 6.00000000e+00, 7.86000000e+02,
  7.20558608e-01, 1.65517477e+15, 1.65517477e+15, 2.20473819e-03,
  0.00000000e+00],
 [2.58109400e-08, 5.19591662e-04, 4.42531893e-04, 7.86000000e+02,
  9.00157173e-02, 3.81997645e-02, 6.00000000e+00, 7.86000000e+02,
  9.86462149e-01, 1.65521202e+14, 1.65521201e+15, 8.11873543e-05,
  2.48772182e-02]])

for i in range(len(inp)):
    output=model.predict(inp[i].reshape(1,-1))
    if(output[0]==0):
        print("Outlier")
    elif(output[0]==1):
        print("Malicious")
    elif(output[0]==2):
        print("Benign")